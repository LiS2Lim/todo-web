<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Todo</title>
	<!-- CSS Style -->
	<style>
		:root {
			font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
			line-height: 1.5;
			font-weight: 400;

			color-scheme: light dark;
			color: rgba(255, 255, 255, .87);
			background-color: #242424;
		}

		.container {
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
		}

		.date {
			font-weight: 800;
			font-size: x-large;
		}

		.todo-box {
			min-width: 400px;
			width: 40vw;
			height: 80vh;
			padding: 10px;
			margin: 5px;
			border-radius: 50px 50px 0 0;
			background-color: #ffffffcc;
		}

		.todo-item {
			color: #000000;
			font-size: x-large;
			user-select: none;
			cursor: pointer;
		}

		.todo-item:hover {
			color: red;
		}

		.deleted {
			text-decoration: line-through;
			color: darkgray;
		}

		.input-area {
			display: flex;
			justify-content: space-between;
			min-width: 400px;
			width: 40vw;
			padding: 10px;
			background-color: #ffffffcc;
			border-radius: 0 0 20px 20px;
		}

		.label {
			height: 50px;
			padding: 10px;
			width: 100%;
			margin-right: 5px;
			border-bottom-left-radius: 15px;
			background-color: #ffffff;
			border: none;
		}

		.text {
			width: 100%;
			height: 100%;
			color: #000000;
			background-color: #ffffff;
			border-bottom-left-radius: 15px;
			border: none;
		}

		.text:focus {
			outline: none;
		}

		.btn {
			min-width: 50px;
			width: 5vw;
			height: 50px;
			padding: 10px;
			border-bottom-right-radius: 15px;
			background-color: #ffffffcc;
			color: black;
			display: flex;
			justify-content: center;
			align-items: center;
			cursor: pointer;
			user-select: none;
		}

		.btn:hover {
			background-color: #e8ffc3;
		}
	</style>
</head>
<body>
	<!-- HTML Body  -->
	<div class="container">
		<!-- Date display area -->
		<div class="date">2024/04/09(火)</div>
		<!-- Todo-List display area -->
		<div class="todo-box">
			<ul id="todo-list"></ul>
		</div>
		<!-- Inputbox display area -->
		<div class="input-area">
			<label class="label">
				<input id="text" class="text" type="text" autocomplete="off"/>
			</label>
			<div id="btn-add" class="btn">Add</div>
		</div>
	</div>

	<!-- Javascript  -->
	<script type="module" defer>
		/*
			DONE "투두 리스트를 로컬스토리지에 저장하기(DB로 저장 전환하기 쉽도록 인터페이스로 연결?)", 
			"취소선이 그어지면 삭제 버튼 표시되게 하기", 
			"삭제 기능 추가하기",
			"취소선 그어진 투두아이템 한꺼번에 삭제하는 버튼추가",
			"등록된 내용 편집 기능 추가하기",
			"글자 길이에 제한두기, 혹은 길어졌을 떄 처리하기", 
			"리스트가 많아지면 스크롤바 표시",
			"투두리스트의 순서를 바꿀 수 있게하기",
			"투두리스트 UI를 체크박스 형태로 변경",
			"상단 날짜 영역에 시간도 같이 표시하기(시:분:초)",
		*/

		/* ############### Functions start ################# */

		//// 로컬스토리지에 투두리스트를 추가하는 함수
		const addLocalStorage = (todo) => {
			todoList.push(todo);
			localStorage.setItem('todoList', JSON.stringify(todoList));
		};
		
		//// 투두리스트 영역에 아이템을 추가하는 함수
		const createTodoItem = (text) => {
			const elLi = document.createElement("li");
			elLi.innerText = text;
			elLi.classList.add("todo-item");
			elLi.addEventListener("click", deletedList);
			elList.appendChild(elLi);
			//로컬스토리지에도 추가
			addLocalStorage(text);
		}

		//// 투두리스트의 아이템을 클릭했을 때 취소선 긋는 함수
		const elList = document.getElementById("todo-list");
		const deletedList = (e) => {
			const isContains = e.target.classList.contains("deleted");
			if (isContains) {
				e.target.classList.remove("deleted");
			} else {
				e.target.classList.add("deleted");
			}
		}

		//// 입력된 텍스트를 가져와 투두리스트와 배열에 추가하는 함수
		const addTodoItem = () => {
			const text = document.getElementById("text");
			if (text.value == "") return;
			createTodoItem(text.value);
			text.value = "";
		}
		/* ############### Functions end ################# */

		//// 상단의 날짜 표시
		const dateElement = document.getElementsByClassName("date")[0];
		const today = new Date();
		const option = {
			year: "numeric",
			month: "2-digit",
			day: "2-digit",
			weekday: 'short',
		}
		dateElement.innerText = today.toLocaleDateString(undefined, option);

		////투두리스트 변수 선언
		let todoList = [];
		
		////로컬스토리지에서 저장된 데이터를 가져옴
		let storageList = localStorage.getItem('todoList');

		////데이터가 존재하면 파싱하여 todoList에 세팅
		////존재하지 않으면 빈 배열을 로컬스토리지에 저장
		if (storageList) {
			todoList = JSON.parse(storageList);
		} else {
			localStorage.setItem('todoList', JSON.stringify(todoList));
		}

		////투두리스트 전체를 순회하며 투두리스트 영역에 추가
		todoList.forEach(text => {
			const liElement = document.createElement("li");
			liElement.innerText = text;
			liElement.classList.add("todo-item");
			liElement.addEventListener("click", deletedList);
			elList.appendChild(liElement);
		});

		//// Add버튼을 클릭했을 때 투두리스트가 추가되도록 이벤트 리스닝 추가
		const btnAdd = document.getElementById("btn-add");
		btnAdd.addEventListener("click", addTodoItem);

		//// 텍스트박스에서 엔터를 눌러도 등록 동작이 실행되도록
		const text = document.getElementById("text");
		text.addEventListener("keypress", (e) => {
			if (e.keyCode === 13) {
				addTodoItem();
			}
		})
		
	</script>
</body>
</html>